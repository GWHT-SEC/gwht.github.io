{{ $disableImageOptimization := .Page.Site.Params.disableImageOptimization | default false }}
{{ with .Params.externalUrl }}
<a href="{{ . }}" target="_blank" rel="external noopener noreferrer" class="block w-full max-w-[300px]">
{{ else }}
<a href="{{ .RelPermalink }}" class="block w-full max-w-[300px]">
{{ end }}
  <div class="border border-neutral-200 dark:border-neutral-700 rounded-md overflow-hidden shadow-sm relative bg-white dark:bg-neutral-900 text-xs flex items-center h-[96px]">

    {{/* ---- Open Graph ---- */}}
    {{- with $.Params.images -}}
      {{- range first 1 . }}
        <meta property="og:image" content="{{ . | absURL }}" />
      {{- end -}}
    {{- else -}}
      {{- $images := $.Resources.ByType "image" -}}
      {{- $featured := $images.GetMatch "*feature*" -}}
      {{- if not $featured }}{{ $featured = $images.GetMatch "{*cover*,*thumbnail*}" }}{{ end -}}
      {{ if and .Params.featureimage (not $featured) }}
        {{- $url:= .Params.featureimage -}}
        {{ $featured = resources.GetRemote $url }}
      {{ end }}
      {{- if not $featured }}{{ with .Site.Params.defaultFeaturedImage }}{{ $featured = resources.Get . }}{{ end }}{{ end -}}
      {{ if .Params.hideFeatureImage }}{{ $featured = false }}{{ end }}

      {{- with $featured -}}
        {{ if or $disableImageOptimization (strings.HasSuffix . ".svg") }}
          <div class="w-[96px] h-[96px] shrink-0 overflow-hidden">
            <img src="{{ .RelPermalink }}" alt="{{ $.Title }}" class="w-full h-full object-cover" />
          </div>
        {{ else }}
          {{ with .Resize "96x96" }}
            <div class="w-[96px] h-[96px] shrink-0 overflow-hidden">
              <img src="{{ .RelPermalink }}" alt="{{ $.Title }}" class="w-full h-full object-cover" />
            </div>
          {{ end }}
        {{ end }}
      {{- end -}}
    {{- end }}

    {{ if and .Draft .Site.Params.article.showDraftLabel }}
      <span class="absolute top-0 right-0 m-1">
        {{ partial "badge.html" (i18n "article.draft" | emojify) }}
      </span>
    {{ end }}

    <div class="px-3 py-2 text-left flex-1 overflow-hidden">
      <div class="font-semibold text-neutral-800 dark:text-neutral truncate">
        {{ .Title | emojify }}
      </div>
      {{ with .Params.role }}
      <div class="text-[10px] text-neutral-500 dark:text-neutral-400 truncate">
        {{ . }}
      </div>
      {{ end }}
      {{ if .Params.showSummary | default (.Site.Params.list.showSummary | default false) }}
        <div class="text-[10px] text-neutral-600 dark:text-neutral-400 line-clamp-2">
          {{ .Summary | plainify }}
        </div>
      {{ end }}
    </div>
  </div>
</a>
